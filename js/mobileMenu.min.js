!function(t,e,i){function s(e,i){this.options=t.extend({},n,i),this.element=e,this.init()}var n={width:1024,next:'<span class="arrow">&rsaquo;</span>',prev:'<span class="back-arrow">&lsaquo;</span>',linkSwitch:!1,showParent:!0};s.prototype.init=function(){function i(e,i,s){e.each(function(e){void 0!=t(this).attr(i)?s.push(t(this).attr(i)):s.push("")})}function s(e,i,s){e.each(function(e){var n=s[e];t(this).attr(i,n)})}function n(){t("body").toggleClass("bodyFixed"),setTimeout(function(){t(".multilevelMenu ul").attr("class","")},200)}function l(){if(!(t(".multilevelMenu").length>0))return!1;t("body").append('<span class="js-swipe"></span>');var e=0,i=0;t(".js-swipe, .multilevelMenu").on("touchstart",function(t){e=t.originalEvent.changedTouches[0].pageX}),t(".js-swipe").on("touchend",function(t){(i=t.originalEvent.changedTouches[0].pageX)>e&&n()}),t(".multilevelMenu").on("touchend",function(s){(i=s.originalEvent.changedTouches[0].pageX)<e-20&&(t("body").removeClass("bodyFixed"),setTimeout(function(){t(".multilevelMenu ul").attr("class","")},200))})}function a(){function i(t,e){t.preventDefault(),t.stopPropagation();var i=e.closest("li").children("ul"),s=i.innerHeight();e.parents("ul").addClass("close-list").height(s),i.addClass("active-menu").height(s)}function n(e,i){e.length>0&&(e=e.substring(0,e.length-1)),i.closest("li").find("li.back").text(e),t(".js-back").append(o.options.prev)}if((e.innerWidth?e.innerWidth:t(e).width())<o.options.width){if(!w){w=!0,c.removeAttr("id"),c.removeClass(),c.addClass("multilevelMenu"),v.removeClass(),v.removeAttr("id"),m.removeClass(),g.removeClass(),l();var a=c.find("a");a.append(function(e,i){var s="";return t(this).parent("li").find("ul").length>0&&(s=o.options.next),t(s).addClass("js-arrow")}),c.find("li").find("ul").prepend('<li class="back js-back">Назад</li>'),1==o.options.linkSwitch?t(a).on("click",function(e){t(this).next("ul").length>0&&i(e,t(this)),n(t(this).text(),t(this))}):t(a).on("click",".js-arrow",function(e){i(e,t(this)),n(t(this).parents("a").text(),t(this))}),t(".js-back").click(function(){var e=t(this).closest("ul.close-list"),i=0;e.children("li").each(function(e){i+=t(this).innerHeight()}),e.removeClass("close-list"),t(this).parents("ul").innerHeight(i),t(this).closest("ul").addClass("hidden-menu").attr("style","");var s=this;setTimeout(function(){t(s).closest("ul").removeClass("active-menu hidden-menu")},200)})}}else w&&(w=!1,c.attr("id",r),c.attr("class",u),c.find("ul").attr("style",""),s(v,"class",d),s(v,"id",h),s(m,"class",f),s(g,"class",p),t(".js-arrow, .js-back, .js-swipe").detach()),t("body").removeClass("bodyFixed")}var o=this,c=this.element,r=c.attr("id"),u=c.attr("class"),d=[],h=[],f=[],p=[],v=c.find("ul"),m=c.find("li"),g=c.find("a"),w=!1;i(v,"class",d),i(v,"id",h),i(m,"class",f),i(g,"class",p),t("body").append('<div class="multilevelOverlay js-overlay"></div>'),a(),t(e).resize(function(){a()}),t(".js-toggle").add(t(".js-overlay")).on("click",function(){n(),c.find("ul").attr("style","")})},t.fn.mobileMenu=function(t){return new s(this.first(),t),this.first()}}(jQuery,window,document);