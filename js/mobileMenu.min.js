!function(t,e,i){function n(e,i){this.options=t.extend({},s,i),this.element=e,this.init()}var s={width:1024,next:'<span class="arrow">&rsaquo;</span>',prev:'<span class="back-arrow">&lsaquo;</span>',linkSwitch:!1,showParent:!0};n.prototype.init=function(){function i(e,i,n){e.each(function(e){void 0!=t(this).attr(i)?n.push(t(this).attr(i)):n.push("")})}function n(e,i,n){e.each(function(e){var s=n[e];t(this).attr(i,s)})}function s(){t("body").toggleClass("bodyFixed"),setTimeout(function(){t(".multilevelMenu ul").attr("class","")},200)}function l(){if(!(t(".multilevelMenu").length>0))return!1;t("body").append('<span class="js-swipe"></span>');var e=0,i=0;t(".js-swipe, .multilevelMenu").on("touchstart",function(t){e=t.originalEvent.changedTouches[0].pageX}),t(".js-swipe").on("touchend",function(t){(i=t.originalEvent.changedTouches[0].pageX)>e&&s()}),t(".multilevelMenu").on("touchend",function(n){(i=n.originalEvent.changedTouches[0].pageX)<e-30&&(t("body").removeClass("bodyFixed"),setTimeout(function(){t(".multilevelMenu ul").attr("class","")},200))})}function a(){function i(t,e){t.preventDefault(),t.stopPropagation();var i=e.closest("li").children("ul"),n=i.innerHeight()+15;e.parents("ul").addClass("close-list").height(n),i.addClass("active-menu").height(n)}function s(t,e){t.length>0&&(t=t.substring(0,t.length-1)),e.closest("li").find("li.back").text(t).append(o.options.prev)}if((e.innerWidth?e.innerWidth:t(e).width())<o.options.width){if(!w){w=!0,c.removeAttr("id"),c.removeClass(),c.addClass("multilevelMenu"),v.removeClass(),v.removeAttr("id"),m.removeClass(),g.removeClass(),l();var a=c.find("a");a.append(function(e,i){var n="";return t(this).parent("li").find("ul").length>0&&(n=o.options.next),t(n).addClass("js-arrow")}),c.find("li").find("ul").prepend('<li class="back js-back">Назад</li>'),1==o.options.linkSwitch?t(a).on("click",function(e){t(this).next("ul").length>0&&i(e,t(this)),s(t(this).text(),t(this))}):t(a).on("click",".js-arrow",function(e){i(e,t(this)),s(t(this).parents("a").text(),t(this))}),t(".js-back").click(function(){var e=t(this).closest("ul.close-list"),i=0;e.children("li").each(function(e){i+=t(this).innerHeight()}),e.removeClass("close-list"),t(this).parents("ul").innerHeight(i),t(this).closest("ul").addClass("hidden-menu").attr("style","");var n=this;setTimeout(function(){t(n).closest("ul").removeClass("active-menu hidden-menu")},200)})}}else w&&(w=!1,c.attr("id",r),c.attr("class",u),c.find("ul").attr("style",""),n(v,"class",d),n(v,"id",h),n(m,"class",f),n(g,"class",p),t(".js-arrow, .js-back, .js-swipe").detach()),t("body").removeClass("bodyFixed")}var o=this,c=this.element,r=c.attr("id"),u=c.attr("class"),d=[],h=[],f=[],p=[],v=c.find("ul"),m=c.find("li"),g=c.find("a"),w=!1;i(v,"class",d),i(v,"id",h),i(m,"class",f),i(g,"class",p),t("body").append('<div class="multilevelOverlay js-overlay"></div>'),a(),t(e).resize(function(){a()}),t(".js-toggle").add(t(".js-overlay")).on("click",function(){s(),c.find("ul").attr("style","")})},t.fn.mobileMenu=function(t){return new n(this.first(),t),this.first()}}(jQuery,window,document);